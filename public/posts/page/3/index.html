<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Posts | Pawel Wiejkut</title>
<meta name="keywords" content="" />
<meta name="description" content="Posts - Pawel Wiejkut">
<meta name="author" content="">
<link rel="canonical" href="https://pawelwiejkut.dev/posts/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.ac4bcbb73df0e6ab1ca259fb2803b8b2c1dd02cbb6ad0840029b799f5c5360ba.css" integrity="sha256-rEvLtz3w5qscoln7KAO4ssHdAsu2rQhAApt5n1xTYLo=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://pawelwiejkut.dev/profile.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://pawelwiejkut.dev/profile.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://pawelwiejkut.dev/profile.png">
<link rel="apple-touch-icon" href="https://pawelwiejkut.dev/profile.png">
<link rel="mask-icon" href="https://pawelwiejkut.dev/profile.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.105.0">
<link rel="alternate" type="application/rss+xml" href="https://pawelwiejkut.dev/posts/index.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-3R9CLWGY39"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-3R9CLWGY39', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Posts" />
<meta property="og:description" content="Pawe≈Ç Wiejkut homepage. ABAP BW SAC HANA Tips &amp; Tricks üë®üèª‚Äçüíª" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://pawelwiejkut.dev/posts/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content="Pawe≈Ç Wiejkut homepage. ABAP BW SAC HANA Tips &amp; Tricks üë®üèª‚Äçüíª"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://pawelwiejkut.dev/posts/"
    }
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://pawelwiejkut.dev/" accesskey="h" title="Pawel Wiejkut (Alt + H)">Pawel Wiejkut</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://pawelwiejkut.dev/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span><i class='fa fa-heart'></i>Search</span>
                </a>
            </li>
            <li>
                <a href="https://pawelwiejkut.dev/about-me/" title="About me">
                    <span>About me</span>
                </a>
            </li>
            <li>
                <a href="https://pawelwiejkut.dev/bw/" title="BW">
                    <span>BW</span>
                </a>
            </li>
            <li>
                <a href="https://pawelwiejkut.dev/sac-tutorial/" title="SAC">
                    <span>SAC</span>
                </a>
            </li>
            <li>
                <a href="https://pawelwiejkut.dev/abap-od-podstaw/" title="ABAP od postaw üáµüá± ">
                    <span>ABAP od postaw üáµüá± </span>
                </a>
            </li>
            <li>
                <a href="https://pawelwiejkut.dev/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://pawelwiejkut.dev/posts/" title="Posts">
                    <span class="active">Posts</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>Posts</h1>
</header>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>How AMDP TRFN is executed<sup><span class="entry-isdraft">&nbsp;&nbsp;[draft]</span></sup>
    </h2>
  </header>
  <section class="entry-content">
    <p>ADSO definition:
TRFN definition:
In general execution looks like: ABAP Method-&gt;Call SQL on HANA-&gt;Execute ‚Ä¶ -&gt; select
Step by step:
From ABAP site: cl_rstran_db_stat=&gt;execute_haap() is executed with SQL like: SELECT &#34;FIELD1&#34; AS &#34;FIELD1&#34; , &#34;0RECORDMODE&#34; AS &#34;RECORDMODE&#34; , &#34;RECORD&#34; AS &#34;RECORD&#34; FROM &#34;SAPA4H&#34;.&#34;/1BCAMDP/0BW:DAP:TR_04TFNXDAAVG5T5E8AZJ239HYT&#34; (&#39;PLACEHOLDER&#39;=(&#39;$$aggregation$$&#39;,&#39;&#34;BW_HAP__________DB_AGGREGATION&#34;=&#39;&#39;&#39;&#39;&#39;), &#39;PLACEHOLDER&#39;=(&#39;$$client$$&#39;,&#39;001&#39;), &#39;PLACEHOLDER&#39;=(&#39;$$keydate$$&#39;,&#39;20211110&#39;), &#39;PLACEHOLDER&#39;=(&#39;$$langu$$&#39;,&#39;E&#39;), &#39;PLACEHOLDER&#39;=(&#39;$$objvers$$&#39;,&#39;&#34;OBJVERS&#34; = &#39;&#39;A&#39;&#39;&#39;), &#39;PLACEHOLDER&#39;=(&#39;$$shift_decimal_places$$&#39;,&#39;&#34;BW_HAP__________SHIFT_DECIMAL_PLACES&#34;=&#39;&#39;I&#39;&#39;&#39;), &#39;PLACEHOLDER&#39;=(&#39;TR_04TFNXDAAVG5T5E8AZJ239HYT.$$adso_dtp_extraction_mode$$&#39;,&#39;&#34;_IS_FULL_KEY&#34; = 1 AND ( (&#34;1TECHPROV_KEY&#34; = &#39;&#39;ZAMDP$C&#39;&#39; OR &#34;1TECHPROV_KEY&#34; = &#39;&#39;ZAMDP&#39;&#39; ) )&#39;), &#39;PLACEHOLDER&#39;=(&#39;TR_04TFNXDAAVG5T5E8AZJ239HYT.$$runid$$&#39;,&#39;&#34;BW_HAP__________RUNID&#34;=&#39;&#39;96SBW6PMF5XU9CAGGGHRMDRSY&#39;&#39; AND &#34;BW_HAP__________HAP_SEQ_NUMBER&#34;=&#39;&#39;0&#39;&#39;&#39;),&#39;PLACEHOLDER&#39; = (&#39;ce_settings&#39;, &#39;{&#34;enable_partitioned_execution&#34;: &#34;0&#34;, &#34;ceqo_enable_rownum_expr_general&#34;: &#34;1&#34;}&#39;) ) WITH HINT ( ROUTE_BY_CARDINALITY(&#34;/BIC/AZAMDP2&#34;) ) This is a</p>
  </section>
  <footer class="entry-footer"><span title='2021-11-11 22:58:24 +0200 +0200'>November 11, 2021</span>&nbsp;¬∑&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to How AMDP TRFN is executed" href="https://pawelwiejkut.dev/posts/how-amdp-is-executed/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Call SAP HANA function with table
    </h2>
  </header>
  <section class="entry-content">
    <p>How to run the HANA SQL function where an output table is required? Example function (from this tutorial): CREATE TYPE &#34;TT_RESTAURANTS&#34; AS TABLE (&#34;node_id&#34; INTEGER, &#34;distance&#34; INTEGER, &#34;hops&#34; BIGINT); CREATE OR REPLACE PROCEDURE &#34;NEAREST_RESTAURANT&#34;(IN startV INT, OUT res &#34;TT_RESTAURANTS&#34;) LANGUAGE GRAPH READS SQL DATA AS BEGIN GRAPH g = Graph(&#34;SKIING&#34;); VERTEX v_s = Vertex(:g, :startV); MULTISET&lt;Vertex&gt; rests = v IN Vertices(:g) WHERE :v.&#34;restaurant&#34; == N&#39;TRUE&#39;; ALTER g ADD TEMPORARY VERTEX ATTRIBUTE (INT &#34;distance&#34; = 0); ALTER g ADD TEMPORARY VERTEX ATTRIBUTE (BIGINT &#34;hops&#34; = 0L); FOREACH rest in :rests { VERTEX v_rest = Vertex(:g, :rest....</p>
  </section>
  <footer class="entry-footer"><span title='2021-11-11 11:44:24 +0200 +0200'>November 11, 2021</span>&nbsp;¬∑&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to Call SAP HANA function with table" href="https://pawelwiejkut.dev/posts/call-function-table/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Call SAP HANA function with table
    </h2>
  </header>
  <section class="entry-content">
    <p>How to run the HANA SQL function where an output table is required? Example function (from this tutorial): CREATE TYPE &#34;TT_RESTAURANTS&#34; AS TABLE (&#34;node_id&#34; INTEGER, &#34;distance&#34; INTEGER, &#34;hops&#34; BIGINT); CREATE OR REPLACE PROCEDURE &#34;NEAREST_RESTAURANT&#34;(IN startV INT, OUT res &#34;TT_RESTAURANTS&#34;) LANGUAGE GRAPH READS SQL DATA AS BEGIN GRAPH g = Graph(&#34;SKIING&#34;); VERTEX v_s = Vertex(:g, :startV); MULTISET&lt;Vertex&gt; rests = v IN Vertices(:g) WHERE :v.&#34;restaurant&#34; == N&#39;TRUE&#39;; ALTER g ADD TEMPORARY VERTEX ATTRIBUTE (INT &#34;distance&#34; = 0); ALTER g ADD TEMPORARY VERTEX ATTRIBUTE (BIGINT &#34;hops&#34; = 0L); FOREACH rest in :rests { VERTEX v_rest = Vertex(:g, :rest....</p>
  </section>
  <footer class="entry-footer"><span title='2021-11-11 11:44:24 +0200 +0200'>November 11, 2021</span>&nbsp;¬∑&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to Call SAP HANA function with table" href="https://pawelwiejkut.dev/posts/lumira-cheatsheet/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>How to install ABAP 1909 on mac M1
    </h2>
  </header>
  <section class="entry-content">
    <p>How to run ABAP 1909 on MacOs with M1? For me, the best idea was to use UTM. I also tried before with docker without success - in the end, there was always an error.
Install UTM
Download Ubuntu Server x64 bit version
Create virtual machine on UTM (220 GB storage, 6-7 CPU‚Äôs, additional flags) Install Ubuntu server on UTM
Install docker sudo apt-get update sudo apt-get install \ ca-certificates \ curl \ gnupg \ lsb-release curl -fsSL https://download....</p>
  </section>
  <footer class="entry-footer"><span title='2021-11-10 20:44:24 +0200 +0200'>November 10, 2021</span>&nbsp;¬∑&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to How to install ABAP 1909 on mac M1" href="https://pawelwiejkut.dev/posts/abap1909-dev-m1/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>BW important programs / Function modules / Tables 
    </h2>
  </header>
  <section class="entry-content">
    <p>Almost all of these programs are included in my GitHub development ‚Äúbw_toolbox‚Äù. If you want, you can just implement this in an easy way to your system. Please check by clicking here.
Activate: Name Category Type Description RSDG_TRFN_ACTIVATE TRFN PROG Activate transformations on the system. If you are missing fields in source or target - then it will not work correctly. RSDS_DATASOURCE_ACTIVATE_ALL RSDS PROG Activate data source RSBKDTPREPAIR DTP PROG Activate data transfer process RSDG_HCPR_ACTIVATE HCPR PROG Activate composite provider RSDG_CUBE_ACTIVATE CUBE PROG Activate cube RSDG_ADSO_ACTIVATE ADSO PROG Activate Advanced DataStore Object RSDG_IOBJ_ACTIVATE IOBJ PROG Activate InfoObject Maintenance: Name Category Type Description RSDG_AFTER_IMPORT_FOR_CORR N/A PROG Reimport transport RSBM_GUI_CHANGE_USTATE DTP FM Change DTP request status RSPM_PROCESS_MONITOR DTP PROG Change DTP request status ADSO RSPC_VARIANT_DELETE RSPC FM Delete process chain variant RSPC_API_CHAIN_START RSPC FM Start process chain immediately ( even scheduled ) DB_DROP_TABLE DEST PROG Drop tables under the OpenHub RSDG_IOBJ_REORG IOBJ PROG Repair Infoobject RSPC_PROCESS_FINISH RSPC PROG Process chain variant status change BAPI_USER_UNLOCK N/A FM Unlock user BW4 GUI Versions Description Name Type DTP View rsbk0001 PROG TRFN View rstran_gui_start PROG DataSource View rsds Transaction Infoprovider View (display data) rsoadso Transaction Manage Request rsmng Transaction Tables Description Name Check iobj assigned to extractor field RSTSFIELD RSOFIELSMAP Others Description Name Type Remove file SCMS_FILE_DELETE FM Rename file SCMS_FILE_COPY FM Upload file ARCHIVFILE_CLIENT_TO_SERVER FM </p>
  </section>
  <footer class="entry-footer"><span title='2021-11-04 11:15:20 +0100 CET'>November 4, 2021</span>&nbsp;¬∑&nbsp;2 min</footer>
  <a class="entry-link" aria-label="post link to BW important programs / Function modules / Tables " href="https://pawelwiejkut.dev/posts/bw-important-programs/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>AMDP ABAP Transformation execution
    </h2>
  </header>
  <section class="entry-content">
    <p>You may wonder how to execute AMDP TRFN directly via ABAP. It seems that the best idea is to use the method below:
cl_rstran_db_stat=&gt;execute_haap( EXPORTING i_processing_phase = lr_request-&gt;if_rsbk_request~get_stage( )-stage_id i_target_request = lr_request-&gt;if_rsbk_request~get_requid( ) i_dtp = lr_dtp-&gt;n_dtp i_t_trfn = lr_request-&gt;if_rsbk_request~get_t_transformation( i_only_she_relevant = rs_c_true ) i_r_log = lr_request-&gt;if_rsbk_request~get_log( ) i_simulation = lr_request-&gt;get_simulation( ) i_th_bp = lt_bp i_r_outbound = lr_outbound IMPORTING e_r_analysis_rt = DATA(lr_analysis) ). DATA(lr_segment_outbound) = lr_outbound-&gt;get_segment( i_segid = 001 ). Unfortunately you can‚Äôt put data into this method - it always reads it from the ADSO table and provides only the result....</p>
  </section>
  <footer class="entry-footer"><span title='2021-10-17 21:44:24 +0200 CEST'>October 17, 2021</span>&nbsp;¬∑&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to AMDP ABAP Transformation execution" href="https://pawelwiejkut.dev/posts/amdp-abap-trfn/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Direct Update ADSO ABAP API
    </h2>
  </header>
  <section class="entry-content">
    <p>How to insert the data into the BW ADSO on the BW on Hana and BW4HANA ? The easy way is just to use the official function module delivered by SAP
Example ADSO: Example code:
REPORT zadsoamdp. DATA: lt_data TYPE STANDARD TABLE OF /bic/aadsoamdp2, lt_msg TYPE rs_t_msg. APPEND VALUE #( field1 = &#39;1&#39; field2 = &#39;2&#39; ) TO lt_data. CALL FUNCTION &#39;RSDSO_DU_WRITE_API&#39; EXPORTING i_adsonm = &#39;ADSOAMDP&#39; it_data = lt_data IMPORTING et_msg = lt_msg EXCEPTIONS write_failed = 1 datastore_not_found = 2 OTHERS = 3....</p>
  </section>
  <footer class="entry-footer"><span title='2021-10-17 19:35:53 +0200 CEST'>October 17, 2021</span>&nbsp;¬∑&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to Direct Update ADSO ABAP API" href="https://pawelwiejkut.dev/posts/du-adso-api/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>SAP NPL 7.52 does not start
    </h2>
  </header>
  <section class="entry-content">
    <p>This time I will show you how to fix the issue with your SAP ABAP Developer instance which don‚Äôt want to start. This article is about the license issue, which has expired 1.04.2021. In this case, the command starts ALL, will stick on: The database is not available via R3trans ------------------------------------------- starting database NPL ... Log file: /sybase/NPL/startdb.log
Or Stop returns modlib.jslib.caughtException
We have to download a new license file from https://developers....</p>
  </section>
  <footer class="entry-footer"><span title='2021-04-02 22:01:24 +0200 CEST'>April 2, 2021</span>&nbsp;¬∑&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to SAP NPL 7.52 does not start" href="https://pawelwiejkut.dev/posts/npl-wont-start/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Joby W ABAPie
    </h2>
  </header>
  <section class="entry-content">
    <p>Z tej lekcji dowiesz siƒô jak dzia≈ÇajƒÖ joby w ABAPie. Napiszemy prosty program kt√≥ry bedzie odpowiedzialny za wstawienie danych do tabeli a nastƒôpnie ustawimy go jako proces w tle. Dodatkowo opowiadam tez o tym czym sƒÖ warianty, oraz jak je tworzyƒá. To wideo jest czƒô≈õciƒÖ p≈Çatnego kursu ABAP od podstaw, dostƒôpnego na https://saponit.pl/kurs-abap</p>
  </section>
  <footer class="entry-footer"><span title='2021-01-23 18:25:44 +0100 CET'>January 23, 2021</span>&nbsp;¬∑&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to Joby W ABAPie" href="https://pawelwiejkut.dev/posts/joby-w-abapie/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>How to check who deleted your BW object?
    </h2>
  </header>
  <section class="entry-content">
    <p>Most of the objects are not modifiable on the quality or production systems, but we have exceptions like Infopackages on BW. Yesterday I have to check who deleted an object from the system and fortunately, there is the log for this operation. I will show you how to check this.
We have to go to the transaction SGL1 and search for RSSM Now you should be able to find the impostor üôÇ </p>
  </section>
  <footer class="entry-footer"><span title='2021-01-10 20:44:24 +0200 +0200'>January 10, 2021</span>&nbsp;¬∑&nbsp;1 min</footer>
  <a class="entry-link" aria-label="post link to How to check who deleted your BW object?" href="https://pawelwiejkut.dev/posts/check-who-deleted/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="prev" href="https://pawelwiejkut.dev/posts/page/2/">¬´ Prev Page</a>
    <a class="next" href="https://pawelwiejkut.dev/posts/page/4/">Next Page ¬ª</a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://pawelwiejkut.dev/">Pawel Wiejkut</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js" integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
const images = Array.from(document.querySelectorAll(".post-content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0,  
    scrollOffset: 40,  
    container: null,  
    template: null  
  });
});
</script>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
